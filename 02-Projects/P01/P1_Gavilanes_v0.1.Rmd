---
title: "Project 1"
author: "Hector Gavilanes"
format: html
self-contained: true
editor: source
---

```{r setup, echo = TRUE, warnings = FALSE, message = FALSE}
library(tidyverse)
library(gsheet)
library(formattable)
library(gridExtra)
```


**1. Members of the UWF basketball team decided to see if there was a difference in scoring on free throws during the first and second halves of games. Data was collected over thirteen games and is as follows:**

| 1st Half | 19 | 13 | 7 | 21 | 20 | 13 | 14 | 8 | 11 | 20 | 16 | 9 | 10 |
|----------|----|----|---|----|----|----|----|---|----|----|----|---|----|
| **2nd Half** | **17** | **9**  | **8** | **22** | **14** | **9** | **15** | **8** | **12** | **14** | **8**  | **8** | **10** |

```{r}
# clear environment
rm(list = ls())
# data as vector
half_1 <- c(19, 13, 7, 21, 20, 13, 14, 8, 11, 20, 16, 9, 10)
half_2 <- c(17, 9, 8, 22, 14, 9, 15, 8, 12, 14, 8, 8, 10)

# create data frame
basketball <- data.frame(
  half_1st = half_1,
  half_2nd = half_2
)
# transform table from wide to long
data_long <- basketball %>% 
  drop_na() %>% 
  pivot_longer(cols = half_1st:half_2nd, 
               names_to = "Time", 
               values_to = "Scores")
# ---CUSTOM COLORS---
custom_green_dark = "#71CA97"
custom_green_light = "#DeF7E9"
custom_gray = "#3D3D3D"
custom_orange = "#FC7307"
custom_purple = "#5A18C9"
custom_tan_light = "#F7E3D4"
custom_density_hue = c(custom_purple,custom_orange)
# ---FUNCTIONS---
# f00 - Change default table format
change_table_format <- function(data_table){
  # local variables
  first_column <- data_table[1]
  dataframe_length <- NCOL(data_table)
  # format
  formattable(data_table, align = c("l",rep("c", dataframe_length - 1)),
              list(first_column = formatter("span", style = ~ style(color = custom_gray, font.weight = "bold")),
              area(row = 1, col = 2:dataframe_length) ~ color_tile(custom_green_light, custom_green_dark)
              )#/end list
              )#/end formattable
}
# f01 - get custom summary statistics
# !! sym() creates a symbol from a string
get_custom_summary <- function(data_table, category, values){
  summary <- data_table %>%
    group_by(!! sym(category)) %>% 
    summarise(SD = sd(!! sym(values)),
              Avg = mean(!! sym(values)),
              Median = median(!! sym(values)),
              Min = min(!! sym(values)),
              Max = max(!! sym(values)),
              IQRange = IQR(!! sym(values))
              )
    return(summary)
}
```

**a. Find the appropriate summary statistics to summarize the data.**
```{r}
# summary statistics with custom table format
change_table_format(get_custom_summary(data_long, "Time","Scores"))
```

**b. Perform the appropriate *t* test to determine if there is a difference in the number of free throws made during the first and second halves of games. Remember to typeset the hypothesis test results.**
```{r}
t.test(basketball$half_1st, basketball$half_2nd,
       paired = TRUE)
```
### Hypothesis
$H_0$: $\mu 1st = \mu 2nd$\
$H_1$: $\mu 1st \ne \mu 2nd$\

### Test Statistics
$t_0 = 2.359$

### p-Value
$p = 0.036$

## Conclusion
Reject $H_0$ at the $\alpha$=0.05 level. There is sufficient evidence to suggest that there is a difference in the number of free throws made during the first and second halves of games.

**c. Perform the appropriate nonparametric test to determine if there is a difference in the number of free throws made during the first and second halves of games. Remember to typeset the hypothesis test results.**
```{r}
wilcox.test(basketball$half_1st, basketball$half_2nd,
            exact = FALSE)
```
### Hypothesis
$H_0$: $M_1st = M_2nd$\
$H_1$: $M_1st \ne M_2nd$\

### Test Statistics
$t_0 = 104.5$

### p-Value
$p = 0.32$

## Conclusion
Keep $H_0$ at the $\alpha$=0.05 level. There is not sufficient evidence to suggest that there is a difference in the number of free throws made during the first and second halves of games.

**d. Construct the necessary graphs / hypothesis tests to assess the assumptions on the *t* test.**

### Assumption
```{r}
graph_paired_qq_plot <- function(data_table, after_sample, before_sample){
  data_table %>%
    mutate(diff = after_sample - before_sample) %>%
    ggplot(aes(sample = diff)) +
    stat_qq(size=3, alpha = 0.6, color = custom_orange) +
    stat_qq_line() +
    theme_bw() +
    labs(title = "Basketball Free Throws", subtitle = "QQ Plot")+
    xlab("Theoretical Basketball Throws") +
    ylab("Sample Basketball Throws")
}
graph_paired_qq_plot(basketball, half_2, half_1)
```
```{r}
# summary statistics
# median by dependent samples
summary_long_table <- data_long %>% 
  group_by(Time) %>%
  select(Time, Scores) %>% 
  summarise_all(list(Median = median))

change_table_format(summary_long_table)

# Basketball density
data_long %>% 
  group_by(Time) %>% 
  ggplot(aes(x = Scores, color = Scores, fill = Time)) +
  geom_density(data = data_long, aes(color = Time), alpha = 0.25)+
  geom_vline(data = summary_long_table, aes(xintercept=Median, color=Time), 
             linetype="dashed", size = 1.1)+
  annotate("text", x=12, y=0.025, label="Median", angle=90, size=5, color= custom_purple) +
  xlim(0,30)+
  labs(title = "Basketball Free Throws", subtitle = "Density Plot")+
  theme_bw()+
  scale_fill_manual(values = custom_density_hue)+
  scale_color_manual(values = custom_density_hue)

```
    
**e. State the assumption(s) on the *t* test and provide your assessment based on results in part (d).**
    
**f. Based on your assessment in part (e), are you going to report the *t* test or the nonparametric test?**
    
**g. Write a brief paragraph describing the results of your analysis. Include summary statistics, results of your chosen hypothesis test from part (f), and a graph to help convey the results.**
    
**2. It is hypothesized that students in College Algebra skip class less often than students in General Chemistry I; both courses seat 90 students. Data on the total number of absences per section was collected for one fall semester, and is as follows:**

| General Chemistry I | 161 | 140 | 136 | 171 | 106 | 149 |
|---------------------|-----|-----|-----|-----|-----|-----|
| **College Algebra** | **158** | **132** | **135** | **185** | **106** | **150** |

**a. Find the appropriate summary statistics to summarize the data.**

**b. Perform the appropriate *t* test to determine if there are fewer absences in College Algebra. Remember to typeset the hypothesis test results.**
    
**c. Perform the appropriate nonparametric test to determine if there are fewer absences in College Algebra. Remember to typeset the hypothesis test results.**
    
**d. Construct the necessary graphs / hypothesis tests to assess the assumptions on the *t* test.**
    
**e. State the assumption(s) on the *t* test and provide your assessment based on results in part (d).**
    
**f. Based on your assessment in part (e), are you going to report the *t* test or the nonparametric test?**
    
**g. Write a brief paragraph describing the results of your analysis. Include summary statistics, results of your chosen hypothesis test from part (f), and a graph to help convey the results.**

    



