---
title: "Statistical Inference on Variances - Week 4, Lecture 1"
author: "Your Name Here"
format: html
self-contained: true
editor: source
---

```{r setup, echo = TRUE, warnings = FALSE, message = FALSE}
install.packages("EnvStats")
library(tidyverse)
library(gsheet)
library(EnvStats)
library(stats)
```

## Question 1: 

**Recall the following dataset from the first week. We have data from 22 elementary schools located in a Florida school district in 1999. Reading and math scores from a standardized test, percent minority of the particular grade level in that school, percent in poverty of the particular grade level in that school, and total number of students in that grade at that school are included.**

```{r, echo = TRUE}
data <- as_tibble(gsheet2tbl("https://docs.google.com/spreadsheets/d/1cVGLLdILMI34xjnzHfJNHua6fJROJwCzUBFgV22OLT4/edit#gid=0"))

clean_data <- data %>% 
  drop_na()
```

#### a. Construct the 99% confidence interval for the standard deviation of math scores for 4th graders.

```{r, echo=TRUE}
math_4grade <- clean_data %>% 
  filter(Grade == 4)

varTest(math_4grade$Math,
        conf.level = 0.99)
low_ci = sqrt(47.12)
high_ci = sqrt(242.86)
```

The 99% CI for $\sigma^2$\ is (47.12, 242.86)
After taking the square root,
The 99% CI for $\sigma$\ is (6.86, 15.58)

#### b. Use the confidence interval found in part A to determine if the standard deviation is smaller than 10.
The UCL, or lower interval is lower than 10.


## Question 2:

**Recall the following dataset from the second week. A large credit union awards quarterly bonuses to its employees. To ensure fairness across departments, data on the bonuses are regularly reviewed for equality. Consider the data in the following Google Sheet, which includes the bonus percentage for each employee in two departments.**

```{r, echo = TRUE}
data <- as_tibble(gsheet2tbl("https://docs.google.com/spreadsheets/d/1q0Ouhr6hGBDp-5oyQuYGcsWTLrsayywVHJS7o17Sm6Y/edit?usp=sharing"))

bonus_data <- data %>% 
  drop_na()
```

#### a. (From two weeks ago!) Use the appropriate *t*-test to determine if the two departments are given different bonus amounts. Test at the &alpha;=0.01 level.

```{r, echo=TRUE}
mortgage <- bonus_data %>% 
  filter(Department == "Mortgage") 
credit <- bonus_data %>% 
  filter(Department == "Credit") 

t.test(bonus_data$Bonus ~ bonus_data$Department,
       conf.level = 0.99)
```

#### b. Use the appropriate test to show that we meet the assumption of equal variance.

```{r, echo=TRUE}
t.test(bonus_data$Bonus ~ bonus_data$Department,
       var.equal = TRUE,
       conf.level = 0.99)

```

#### c. Change the hypothesis used in part A to account for equal variances. Do you reach a different conclusion?

```{r, echo=TRUE}
var.test(mortgage$Bonus, credit$Bonus,
         conf.level = 0.99,
         alternative = "two.sided",
         ratio = 1)

```






