---
title: "Logistic Regression - Week 12, Day 1"
author: "Hector Gavilanes"
format: html
self-contained: true
editor: source
---

```{r, echo=FALSE, warning=FALSE, message=FALSE}
library(tidyverse)
library(gsheet)

```

**Recall the Titanic data from lecture. Use it to answer the following questions.**
```{r}
# clear environment
rm(list = ls())
# load data
data <- as_tibble(gsheet2tbl("https://docs.google.com/spreadsheets/d/1TrJ6jZ3hP6gQk6FvqbMrFUysEUEqle7XfuLnAkZsHYI/edit"))
```

**1. Model survival as a function of age (*Age*), the number of siblings and/or spouses (*SibSp*), the number of parents or children (*Parch*), the class of ticket (*Pclass*), and amount paid for ticket (*Fare*).** 

```{r, echo = TRUE}
m1 <- glm(data$Survived ~ data$Age + data$SibSp + data$Parch + data$Pclass + data$Fare,
          family = binomial)
summary(m1)
```

**1a. Report the model.**
```{r}
m1_coeff <- coefficients(m1)
```

$$
\ln \left( \frac{\hat{\pi}}{1-\hat{\pi}} \right) = `r round(m1_coeff[1],3)` `r round(m1_coeff[2],3)` \text{ age} `r round(m1_coeff[3],3)` \text{ sibling \& spouse} + `r round(m1_coeff[4],3)` \text{ parents \& children} `r round(m1_coeff[5],3)` \text{ pass class} + `r round(m1_coeff[6],3)` \text{ fare}
$$
**1b. Which, if any, are significant predictors of survival? The full hypothesis test is not needed, but you must provide statistical justification.**

```{r, echo = TRUE}
significant <- coef(summary(m1))[,'Pr(>|z|)']
significant < 0.05
round(significant[2:5], 3)

non_significant <- coef(summary(m1))[,'Pr(>|z|)']
non_significant > 0.05
round(non_significant, 3)
```

- Age (p < 0.001), Siblings & Spouses (p = 0.006), Parents & Children (p = 0.023), and Passenger Class (p < 0.001) are significant predictors of survival.
- Fare (0.194) is not a significant predictor of survival. 


**1c. Find the odds ratios and corresponding 95% confidence intervals.**

```{r, echo = TRUE}
round(exp(confint(m1)), 3)
```



**1d. Provide interpretations for the odds ratios for each of the predictors in the model.**
Interpretation
**2. Challenge! Model survival as a function of age (*Age*), the class of ticket (*Pclass*), and sex of passenger (*Sex*).** 

```{r, echo = TRUE}
contrasts(factor(data$Sex))
data <- data[!is.na(data$Sex),]
rownames(data) <- NULL
m2 <- glm(data$Survived ~ data$Age + data$Pclass + factor(data$Sex),
          family = "binomial"(link = "logit"))
summary(m2)


```

**2a. Report the model.**

**2b. Which, if any, are significant predictors of survival? The full hypothesis test is not needed, but you must provide statistical justification.**

```{r, echo = TRUE}

```

**2c. Find the odds ratios and corresponding 95% confidence intervals.**

```{r, echo = TRUE}

```

**2d. Provide interpretations for the odds ratios for each of the predictors in the model.**